/*-----------------------------------------------------------
       ??
 -------------------------------------------------------------*/
--1) department_id? 60? ??? ???? ???? SELECT??? ?????
SELECT l.city
FROM locations l
WHERE l.location_id IN (
    SELECT location_id
    FROM departments
    WHERE department_id = 60
    );

--02)??? 107? ??? ?????,167?? ???? ?? ???? ??,??(first_name),??? ?????.
SELECT department_id
FROM employees
WHERE employee_id = 107;

SELECT salary
FROM employees
WHERE employee_id = 167;

SELECT first_name, employee_id, salary
FROM employees
WHERE salary > (
    SELECT salary
    FROM employees
    WHERE employee_id = 167
    )
AND department_id = (
    SELECT department_id
    FROM employees
    WHERE employee_id = 107
    )
;
   
--3) ?????? ??? ???? ???? ???? ?? ???? ??,??(first_name),??,??? ???? ?????.
SELECT first_name
FROM employees
WHERE salary > (
    SELECT AVG(salary)
    FROM employees
    );

SELECT first_name, employee_id, salary, commission_pct
FROM employees
WHERE commission_pct IS NOT NULL
AND salary > (
    SELECT AVG(salary)
    FROM employees
    );

--4)? ??? ????? 20? ??? ?????? ?? ??? ??? ???? ????? ?????.

SELECT MIN(salary), e.DEPARTMENT_ID
FROM employees e
WHERE (
    SELECT MIN(salary)
    FROM employees d
    WHERE d.department_id = e.department_id
    GROUP BY d.department_id
    ) >
    (
    SELECT MIN(salary)
    FROM employees
    GROUP BY department_id
    HAVING department_id = 20
    )
GROUP BY e.department_id
;



--5) ????? 177? ??? ?? ??? ?? ??? ????(first_name)? ????(job_id)???.  


SELECT first_name, job_id
FROM employees
WHERE job_id = (
    SELECT job_id
    FROM employees
    WHERE employee_id = 177
    );
--6) ?? ??? ?? ??? ??(first_name), ?? ??(job_id) ? ??(salary)? ?????(???? ??).
SELECT first_name, job_id, salary
FROM employees
WHERE salary = (
    SELECT MIN(salary)
    FROM employees
    );

--7)??? ?? ??? ?? ??  ??(job_id)? ?? ??(job_id)? ?? ??? ?????.!!!
SELECT job_id, AVG(salary) average
FROM employees
GROUP BY job_id;

SELECT e.job_id, e.average
FROM (
    SELECT job_id, AVG(salary) average
    FROM employees
    GROUP BY job_id
    ORDER BY average
    )e
WHERE ROWNUM < 2;

--8) ? ??? ?? ??? ?? ??? ??(first_name), ??(salary), ????(department_id)? ?????.
SELECT first_name, salary, department_id
FROM employees
WHERE (department_id, salary) IN (
    SELECT department_id, MIN(salary)
    FROM employees
    GROUP BY department_id
    )
ORDER BY salary;

--9)?? ??? ?????(IT_PROG)? ?? ???? ??? ???? 
--??? ?????(IT_PROG)? ??  ???? ????(employee_id), ??(first_name), 
--?? ??(job_id), ??(salary))? ?????.
SELECT employee_id, first_name, job_id, salary
FROM employees
WHERE salary < ANY (
    SELECT salary
    FROM employees
    WHERE job_id = 'IT_PROG'
    );

--10)????? ?? ?? ??? ??? ?????.
SELECT first_name, employee_id
FROM employees a
WHERE NOT EXISTS(
    SELECT 1
    FROM employees b
    WHERE a.employee_id = b.manager_id
    )
    ;
